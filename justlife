PY := `command -v python3.12 || command -v python3.11 || command -v python3.10 || command -v python3`

setup:
  @echo "üêç Using: {{PY}}"
  @{{PY}} --version
  just poetry
  just pre-commit

poetry:
  if ! command -v poetry &> /dev/null; then
    echo "üì• Installing Poetry..."
    curl -sSL https://install.python-poetry.org | {{PY}} -
    export PATH="$HOME/.local/bin:$PATH"
  fi
  poetry config virtualenvs.in-project true
  poetry env use {{PY}}
  poetry install --sync --no-interaction --with dev

pre-commit:
  if [ -f ".pre-commit-config.yaml" ]; then
    poetry run pre-commit install || echo "‚ö†Ô∏è Pre-commit failed"
    poetry run pre-commit run --all-files || echo "‚ö†Ô∏è Pre-commit hooks failed"
  fi
